\documentclass{article}

\usepackage{Sweave}
\begin{document}
\input{vignette-concordance}

\begin{Schunk}
\begin{Sinput}
> library(DataRemix)
\end{Sinput}
\end{Schunk}
\section{A Toy Example}
Define a simple objective function which calculates the squared error between the DataRemix reconstruction and the original input matrix and the reconstruction error comes with a penalty term. The maximal value should be the same as penalty.
\begin{Schunk}
\begin{Sinput}
> reconstruct <- function(X_reconstruct, X, penalty){
+   return(-sum((X-X_reconstruct)^2)+penalty)
+ }#reconstruct
> 
\end{Sinput}
\end{Schunk}
Genrate a random matrix with dimension 100-by-9 and perform the SVD decomposition.
\begin{Schunk}
\begin{Sinput}
> set.seed(1)
> num_of_row <- 100
> num_of_col <- 9
> X <- matrix(rnorm(num_of_row*num_of_col), nrow = num_of_row, ncol = num_of_col)
> svdres <- svd(X)
\end{Sinput}
\end{Schunk}
Set mt to be 2000.
\begin{Schunk}
\begin{Sinput}
> basis_short <- basis[1:2000,]
\end{Sinput}
\end{Schunk}
Infer the optimal combinations of k, p and $\mu$
\begin{Schunk}
\begin{Sinput}
> DataRemix.res <- DataRemix(svdres, reconstruct, lower_limit = c(1,-1,0), upper_limit = c(length(svdres$d), 1,1), num_of_initialization = 5,num_of_thompson = 50, basis = basis_short, xi = 0.1, full = T, verbose = T, X = X, penalty = 100)
\end{Sinput}
\begin{Soutput}
[1]   1.0000000   6.0000000   0.7600058   0.7491820 -57.7547434
[1]  2.0000000  1.0000000  0.9732232  0.7962543 66.0968707
[1]   3.0000000   2.0000000   0.6264308   0.8342587 -30.9026157
[1]  4.0000000  5.0000000  0.9392592  0.7591503 69.9539900
[1]   5   9   1   1 100
[1]    6.0000000    4.0000000    0.1871164    0.7129497 -343.6128577
[1]  7.0000000  2.0000000  1.0000000  0.9781217 99.6862375
[1]    8.0000000    2.0000000    0.6365943    0.4338173 -219.3052342
[1]   9.0000000   1.0000000   0.5156579   0.7223355 -41.6857087
[1] 10.0000000  7.0000000  1.0000000  0.7208022 89.3331418
[1]   11.0000000    8.0000000    0.4294922    0.5433661 -407.6411023
[1]  12.0000000   9.0000000   1.0000000   0.6235153 100.0000000
[1]   13.0000000    5.0000000    0.5461408    0.9202155 -197.5607230
[1] 14.0000000  8.0000000  0.9772540  0.9936968 97.4999840
[1] 15.0000000  4.0000000  1.0000000  0.5460449 15.0380954
[1]  16.00000000   1.00000000  -0.01736721   1.00000000 -36.59616861
[1]  17.0000000   1.0000000   0.9025561   0.6182613 -24.2629641
[1] 18.0000000  8.0000000  0.8715479  0.3022851  8.0308999
[1] 19.0000000  8.0000000  0.9828520  0.6873251 92.6123180
[1] 20.0000000  8.0000000  0.9454568  0.1996929 47.6990694
[1] 21.0000000  1.0000000  0.5610817  0.9933571 27.8444243
[1]   22.0000000    3.0000000    0.3069788    0.9803562 -189.5818971
[1]   23.0000000    2.0000000    0.9187318    0.0457580 -507.2779252
[1] 24.000000  2.000000  1.000000  0.728877 51.815549
[1]   25.00000000    9.00000000   -0.03176877    1.00000000 -697.04950018
[1] 26.0000000  4.0000000  0.9620278  0.6540939 46.3006161
[1]  27.0000000   6.0000000   1.0000000   0.1181146 -68.9123575
[1] 28.000000  3.000000  1.000000  0.879239 92.259421
[1] 29.0000000  4.0000000  0.9115363  0.8683955 71.8549594
[1]  30   4   1   1 100
[1] 31.0000000  6.0000000  0.9603441  0.5743332 54.4245994
[1] 32.000000  7.000000  1.000000  0.408056 52.051646
[1] 33.0000000  1.0000000  0.8956883  1.0000000 91.3550476
[1]  34.0000000   9.0000000   1.0000000   0.1709873 100.0000000
[1]  35.0000000   9.0000000   1.0000000   0.4663211 100.0000000
[1] 36.0000000  8.0000000  1.0000000  0.1373955 54.7211458
[1] 37.0000000  9.0000000  0.9790435  0.0000000 97.7628833
[1] 38.0000000  8.0000000  1.0000000  0.5319136 86.6671161
[1]  39.0000000   8.0000000   0.7708451   0.6429106 -66.4577644
[1] 40.0000000  3.0000000  0.9880974  0.9615625 98.8513362
[1] 41.0000000  5.0000000  1.0000000  0.9478538 99.1793856
[1]  42.0000000   1.0000000   0.4824335   0.8224709 -10.6572787
[1] 43.0000000  6.0000000  0.9907425  0.8281591 93.2217789
[1] 44.0000000  7.0000000  0.9866542  0.7967908 93.5317794
[1] 45.0000000  4.0000000  1.0000000  0.9221451 97.5009747
[1] 46.0000000  7.0000000  0.9224287  0.9049580 75.0327600
[1]  47.0000000   9.0000000   1.0000000   0.2967019 100.0000000
[1] 48.00000000  9.00000000  0.90033475  0.09436618 57.83476150
[1]  49.00000000   9.00000000   1.00000000   0.09356036 100.00000000
[1] 50.0000000  1.0000000  0.8545062  0.9146200 78.9340674
\end{Soutput}
\end{Schunk}
\end{document}
